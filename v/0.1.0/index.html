<!doctype html>
<html lang="en" data-theme="dim">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Key Vault</title>

    <link rel="icon" type="image/png" href="./logo.png" />
    <link rel="stylesheet" href="./output.css" />
    <script src="./bundle.umd.min.js"></script>
    <script src="./utils.js"></script>
    <script src="./access.js"></script>
    <script src="./events.js"></script>
    <script src="./roles.js"></script>
    <script src="./keys.js"></script>
    <script src="./test-utils.js" defer></script>
    <script src="./script.js" defer></script>

    <link rel="icon" type="image/png" href="https://live-miracles.github.io/key-vault/logo.png" />
    <link rel="stylesheet" href="https://live-miracles.github.io/key-vault/v/0.1.0/output.css" />
    <script src="https://cdn.jsdelivr.net/npm/transliteration/dist/browser/bundle.umd.min.js"></script>
    <script crossorigin src="https://live-miracles.github.io/key-vault/v/0.1.0/utils.js"></script>
    <script crossorigin src="https://live-miracles.github.io/key-vault/v/0.1.0/access.js"></script>
    <script crossorigin src="https://live-miracles.github.io/key-vault/v/0.1.0/events.js"></script>
    <script crossorigin src="https://live-miracles.github.io/key-vault/v/0.1.0/roles.js"></script>
    <script crossorigin src="https://live-miracles.github.io/key-vault/v/0.1.0/keys.js"></script>
    <script crossorigin src="https://live-miracles.github.io/key-vault/v/0.1.0/script.js" defer></script>
  </head>
  <body class="bg-base-100 text-base-content flex min-h-screen min-w-[620px] flex-col">
    <div id="success-alert" role="alert" class="alert alert-success fixed top-3 left-1/2 z-60 hidden w-fit max-w-[700px] -translate-x-1/2 transform">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span class="msg"></span>
    </div>

    <div id="error-alert" role="alert" class="alert alert-error fixed top-3 left-1/2 z-60 hidden w-fit max-w-[700px] -translate-x-1/2 transform">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span class="msg"></span>
    </div>

    <div id="copied-notification" role="alert" class="alert alert-success fixed bottom-3 left-1/2 z-60 hidden w-fit -translate-x-1/2 transform">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span>Copied</span>
    </div>

    <dialog id="event-modal" class="modal">
      <div class="modal-box max-w-[800px]">
        <input type="text" id="event-id-input" class="hidden" />
        <input type="text" id="event-status-input" class="hidden" />

        <div class="focus mx-auto mt-2 w-full max-w-[800px] space-y-3 px-4">
          <fieldset class="fieldset">
            <legend class="fieldset-legend">Event Name<span class="text-error">*</span></legend>
            <input type="text" id="event-name-input" class="input w-full" placeholder="Type here" maxlength="50" />
            <p class="label text-error"></p>
          </fieldset>
        </div>

        <div class="modal-action">
          <form method="dialog">
            <button class="btn mx-2">Cancel</button>
            <button class="btn btn-accent" onclick="saveEventFormBtn(event)">Save</button>
          </form>
        </div>
      </div>
    </dialog>

    <!-- Context Menu -->
    <div id="role-context-menu" class="bg-base-200 border-base-300 rounded-box fixed z-50 hidden border shadow-lg">
      <ul class="menu w-32 p-2">
        <li><a onclick="editRoleRow()" id="edit-role-btn" class="text-accent hidden font-semibold">Edit</a></li>
        <li><a onclick="deleteRoleRow()" id="delete-role-btn" class="text-error hidden font-semibold">Delete</a></li>
      </ul>
    </div>

    <dialog id="role-modal" class="modal">
      <div class="modal-box max-w-[800px]">
        <input type="text" id="role-event-input" class="hidden" />
        <input type="text" id="role-id-input" class="hidden" />

        <div class="focus mx-auto mt-2 w-full max-w-[800px] space-y-3 px-4">
          <div class="flex items-center">
            <fieldset class="fieldset inline-block flex-grow">
              <legend class="fieldset-legend">Email<span class="text-error">*</span></legend>
              <input type="email" id="role-email-input" class="input w-full" placeholder="Type here" maxlength="100" />
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block w-32">
              <legend class="fieldset-legend">Role<span class="text-error">*</span></legend>

              <select class="select" id="role-type-input"></select>
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block w-32">
              <legend class="fieldset-legend">Language<span class="text-error">*</span></legend>
              <select class="select" id="role-language-input"></select>
              <p class="label text-error"></p>
            </fieldset>
          </div>
          <fieldset class="fieldset">
            <legend class="fieldset-legend">Remarks</legend>
            <input type="text" id="role-remarks-input" class="input w-full" placeholder="Type here" maxlength="150" />
          </fieldset>
        </div>

        <div class="modal-action">
          <form method="dialog">
            <button class="btn mx-2">Cancel</button>
            <button class="btn btn-accent" onclick="saveRoleFormBtn(event)">Save</button>
          </form>
        </div>
      </div>
    </dialog>

    <!-- Context Menu -->
    <div id="key-context-menu" class="bg-base-200 border-base-300 rounded-box fixed z-50 hidden border shadow-lg">
      <ul class="menu w-32 p-2">
        <li><a onclick="copyKeyBtn()">Copy Key</a></li>
        <li><a onclick="copyRtmpBtn()">Copy Full URL</a></li>
        <li><a onclick="copyRtmpBtn('2')">Copy Bkp URL</a></li>
        <li><a onclick="copyLinkBtn()" id="copy-link-btn">Copy Link</a></li>
        <li><a onclick="editKeyRow()" id="edit-key-btn" class="text-accent hidden font-semibold">Edit</a></li>
        <li><a onclick="deleteKeyRow()" id="delete-key-btn" class="text-error hidden font-semibold">Delete</a></li>
      </ul>
    </div>

    <dialog id="key-modal" class="modal">
      <div class="modal-box max-w-[800px]">
        <input type="text" id="key-event-input" class="hidden" />
        <input type="text" id="key-id-input" class="hidden" />

        <div class="focus mx-auto mt-2 w-full max-w-[800px] space-y-3 px-4">
          <div class="flex items-center">
            <fieldset class="fieldset inline-block w-32">
              <legend class="fieldset-legend">Color</legend>
              <select class="select" id="key-color-input"></select>
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block w-32">
              <legend class="fieldset-legend">Language<span class="text-error">*</span></legend>
              <select class="select" id="key-language-input"></select>
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block flex-grow">
              <legend class="fieldset-legend">Key Name<span class="text-error">*</span></legend>
              <input type="text" id="key-name-input" class="input w-full" placeholder="Type here" maxlength="50" />
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block flex-grow">
              <legend class="fieldset-legend">Link</legend>
              <input type="text" id="key-link-input" class="input w-full" placeholder="Type here" maxlength="200" />
              <p class="label text-error"></p>
            </fieldset>
          </div>

          <div class="flex items-center">
            <fieldset class="fieldset inline-block w-32">
              <legend class="fieldset-legend">Server URL<span class="text-error">*</span></legend>
              <select class="select" id="key-server-input"></select>
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block flex-grow" id="custom-server">
              <legend class="fieldset-legend">Custom URL<span class="text-error">*</span></legend>
              <input type="text" id="key-custom-server-input" class="input w-full" placeholder="Type here" maxlength="200" />
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block flex-grow">
              <legend class="fieldset-legend">Stream Key<span class="text-error">*</span></legend>
              <input
                type="text"
                id="stream-key-input"
                class="input w-full"
                placeholder="Type here"
                maxlength="200"
                autocomplete="off"
                autocapitalize="off"
                autocorrect="off"
                spellcheck="false" />
              <p class="label text-error"></p>
            </fieldset>
          </div>

          <div class="flex items-center">
            <fieldset class="fieldset inline-block w-32">
              <legend class="fieldset-legend">Backup Server URL</legend>
              <select class="select" id="key-server2-input"></select>
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block flex-grow" id="custom-server2">
              <legend class="fieldset-legend">Backup Custom URL</legend>
              <input type="text" id="key-custom-server2-input" class="input w-full" placeholder="Type here" maxlength="200" />
              <p class="label text-error"></p>
            </fieldset>

            <fieldset class="fieldset ml-2 inline-block flex-grow">
              <legend class="fieldset-legend">Backup Stream Key</legend>
              <input
                type="text"
                id="stream-key2-input"
                class="input w-full"
                placeholder="Type here"
                maxlength="200"
                autocomplete="off"
                autocapitalize="off"
                autocorrect="off"
                spellcheck="false" />
              <p class="label text-error"></p>
            </fieldset>
          </div>

          <fieldset class="fieldset">
            <legend class="fieldset-legend">Remarks</legend>
            <input type="text" id="key-remarks-input" class="input w-full" placeholder="Type here" maxlength="150" />
          </fieldset>
        </div>

        <div class="modal-action">
          <form method="dialog">
            <button class="btn mx-2">Cancel</button>
            <button class="btn btn-accent" onclick="saveKeyFormBtn(event)">Save</button>
          </form>
        </div>
      </div>
    </dialog>

    <div class="bg-base-200 sticky top-0 z-50">
      <div class="relative flex items-center px-5 pt-3 pb-3">
        <!-- LEFT -->
        <span class="text-xl" id="event-name"></span>
        <button title="Edit" class="btn btn-accent btn-xs ml-3 hidden" id="edit-event-btn" onclick="editEventBtn()" disabled>âœŽ</button>
        <button title="Delete" class="btn btn-error btn-xs ml-2 hidden" id="delete-event-btn" onclick="deleteEventBtn()" disabled>âœ–</button>
        <button title="Lock/Unlock" class="btn btn-accent btn-xs ml-2 hidden" id="lock-event-btn" onclick="lockEventBtn()">ðŸ”’</button>
        <button title="Share" class="btn btn-primary btn-xs ml-5 hidden" id="show-roles-btn" onclick="showHideRoles()">ðŸ‘¥</button>

        <!-- CENTER -->
        <div class="absolute left-1/2 -translate-x-1/2">
          <label class="swap">
            <input id="saving-badge" type="checkbox" disabled />
            <div class="swap-off"></div>
            <div class="swap-on flex items-center gap-2">
              <span class="loading loading-infinity loading-xs"></span>
              Saving
            </div>
          </label>
        </div>

        <!-- RIGHT -->
        <div class="ml-auto flex items-center gap-3">
          <span class="text-xl" id="user-email">
            <span class="loading loading-dots"></span>
          </span>
          <span class="mx-3">|</span>
          <progress class="progress progress-accent w-12" max="100" id="storage-progress"></progress>
        </div>
      </div>
    </div>

    <div class="flex min-h-0 w-full flex-1 flex-col">
      <div class="mx-auto hidden max-w-[800px] overflow-x-auto" id="role-table">
        <div class="overflow-x-auto">
          <table class="table">
            <!-- head -->
            <thead>
              <tr class="text-center">
                <th>Email</th>
                <th>Role</th>
                <th>Language</th>
                <th>Remarks</th>
              </tr>
            </thead>
            <tbody id="role-rows">
              <tr>
                <th><span class="loading loading-dots loading-xs"></span></th>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="mt-3 text-center">
          <button class="btn btn-accent btn-sm hidden text-xl font-extrabold" id="add-role-btn" onclick="addRoleBtn()" title="Add">+</button>
        </div>
        <div class="divider"></div>
      </div>

      <div class="min-h-0 flex-1 overflow-y-auto" id="key-table">
        <div class="overflow-x-auto">
          <table class="table-pin-rows table">
            <!-- head -->
            <thead>
              <tr class="text-center">
                <th>Language</th>
                <th></th>
                <th>Name</th>
                <th>Full URL</th>
                <th>Backup URL</th>
                <th>Link</th>
                <th>Remarks</th>
              </tr>
            </thead>
            <tbody id="key-rows">
              <tr>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
                <td><span class="loading loading-dots loading-xs"></span></td>
              </tr>
            </tbody>
          </table>
          <div class="mt-3 text-center">
            <button class="btn btn-accent btn-sm hidden text-xl font-extrabold" id="add-key-btn" title="Add" onclick="addKeyBtn()" title="Add">
              +
            </button>
          </div>
          <div class="divider"></div>
        </div>
      </div>

      <div class="bg-base-200 sticky bottom-0 z-40 mt-1">
        <div class="flex flex-shrink-0 items-center">
          <button class="btn btn-accent btn-xs ml-3 hidden" id="add-event-btn" title="Add" onclick="addEventBtn()">âž•</button>

          <div role="tablist" class="tabs tabs-sm tabs-box ml-3">
            <a role="tab" class="tab tab-active"><span class="loading loading-dots loading-sm"></span> </a>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
